<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visconti Ailesi | BaÅŸvuru</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="index-page">

    <div class="bg-overlay"></div>

    <div style="text-align:center; padding-top:40px;">
        <img src="Visconti.jpg" width="180" style="border-radius:50%; border:2px solid #cfb53b; box-shadow:0 0 25px rgba(207,181,59,0.3);">
        <h1 style="color:#cfb53b; font-family:'Cinzel', serif; margin-top:10px;">VISCONTI AÄ°LESÄ°</h1>
        <p style="color:#888; font-size:0.9rem; letter-spacing:3px;">"GÃœÃ‡. SADAKAT. ONUR."</p>
    </div>

    <a href="admin.html" style="position:absolute; top:20px; right:20px; color:#333; font-size:1.2rem;" title="YÃ¶netim Paneli"><i class="fas fa-key"></i></a>

    <div class="container">
        <section>
            <h2><i class="fas fa-scroll"></i> Resmi BaÅŸvuru KaydÄ±</h2>
            <form id="viscontiForm">
                <div style="display:flex; gap:15px; margin-bottom:20px;">
                    <div style="flex:1;">
                        <label style="color:#fff; display:block; margin-bottom:5px;">Discord ID</label>
                        <input type="text" id="discord_id" class="input-dark" required placeholder="Ã¶rn: kullanÄ±cÄ±#1234">
                    </div>
                    <div style="flex:1;">
                        <label style="color:#fff; display:block; margin-bottom:5px;">IC Ä°sim Soyisim</label>
                        <input type="text" id="ic_name" class="input-dark" required placeholder="Karakter AdÄ±">
                    </div>
                    <div style="width:100px;">
                        <label style="color:#fff; display:block; margin-bottom:5px;">YaÅŸ</label>
                        <input type="number" id="ic_age" class="input-dark" required placeholder="18+">
                    </div>
                </div>

                <div style="background:rgba(0,0,0,0.3); padding:15px; border-radius:8px; border:1px solid #333; margin-bottom:20px; max-height:450px; overflow-y:auto;">
                    <p style="color:#cfb53b; margin-bottom:15px; border-bottom:1px solid #333; padding-bottom:5px;">MÃ¼lakat SorularÄ±</p>
                    
                    <div style="margin-bottom:15px;">
                        <label style="color:#aaa; font-size:0.9rem;">1. Kendinizi ve hikayenizi tanÄ±tÄ±n.</label>
                        <textarea id="q1" class="input-dark" rows="3" required></textarea>
                    </div>
                    <div style="margin-bottom:15px;">
                        <label style="color:#aaa; font-size:0.9rem;">2. Powergaming & Metagaming nedir?</label>
                        <textarea id="q2" class="input-dark" rows="2" required></textarea>
                    </div>
                    <div style="margin-bottom:15px;">
                        <label style="color:#aaa; font-size:0.9rem;">3. FearRP Ã¶rneÄŸi verin.</label>
                        <textarea id="q3" class="input-dark" rows="2" required></textarea>
                    </div>
                    <div style="margin-bottom:15px;">
                        <label style="color:#aaa; font-size:0.9rem;">4. HiyerarÅŸi ve emirlere bakÄ±ÅŸÄ±nÄ±z nedir?</label>
                        <textarea id="q4" class="input-dark" rows="2" required></textarea>
                    </div>
                    <div style="margin-bottom:15px;">
                        <label style="color:#aaa; font-size:0.9rem;">5. Aile iÃ§i ihanet durumunda ne yaparsÄ±nÄ±z?</label>
                        <textarea id="q5" class="input-dark" rows="2" required></textarea>
                    </div>
                    <div style="margin-bottom:15px;">
                        <label style="color:#aaa; font-size:0.9rem;">6. GÃ¼nlÃ¼k aktiflik sÃ¼reniz?</label>
                        <input type="text" id="q6" class="input-dark" required>
                    </div>
                </div>

                <button type="submit" id="submitBtn" class="btn-submit">MÃ¼hÃ¼rle ve GÃ¶nder</button>
            </form>
        </section>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCdoh5yMYMpnmddGpCzXyQtDhSnXo8cLHg",
            authDomain: "veltora.firebaseapp.com",
            databaseURL: "https://veltora-default-rtdb.firebaseio.com",
            projectId: "veltora",
            storageBucket: "veltora.firebasestorage.app",
            messagingSenderId: "62609466462",
            appId: "1:62609466462:web:5813c33c88df4f212600cf",
            measurementId: "G-PQBJN0MLXR"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const WEBHOOK_URL = "https://discord.com/api/webhooks/1465195587577057454/Kk3hwNtZ8STa8NqOMcyk34E3Qig9ZU2Mf4stZ2eqZdzWvv5sibDw1tSuwWVsWM7qGaoT";

        document.getElementById('viscontiForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = document.getElementById('submitBtn');
            btn.innerHTML = 'Ä°ÅŸleniyor...'; btn.disabled = true;

            const form = {
                discord: document.getElementById('discord_id').value,
                name: document.getElementById('ic_name').value,
                age: document.getElementById('ic_age').value,
                q1: document.getElementById('q1').value,
                q2: document.getElementById('q2').value,
                q3: document.getElementById('q3').value,
                q4: document.getElementById('q4').value,
                q5: document.getElementById('q5').value,
                q6: document.getElementById('q6').value
            };
            
            const fullStory = `**Hikaye:** ${form.q1}\n**PG/MG:** ${form.q2}\n**FearRP:** ${form.q3}\n**HiyerarÅŸi:** ${form.q4}\n**Ä°hanet:** ${form.q5}\n**Aktiflik:** ${form.q6}`;

            try {
                await addDoc(collection(db, "basvurular"), {
                    discord: form.discord, icName: form.name, icAge: form.age, story: fullStory,
                    tarih: serverTimestamp(), durum: "Beklemede", rank: ""
                });

                await fetch(WEBHOOK_URL, {
                    method: "POST", headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        username: "Visconti BaÅŸvuru",
                        avatar_url: "https://raw.githubusercontent.com/baron/visconti/main/Visconti.jpg",
                        content: `ðŸ“¢ **Yeni BaÅŸvuru!** <@&1464989769762078934> yetkilileri bekleniyor.`,
                        embeds: [{
                            title: "BaÅŸvuru DetaylarÄ±", color: 16776960,
                            fields: [{name:"KiÅŸi", value:form.name}, {name:"Discord", value:form.discord}],
                            timestamp: new Date().toISOString()
                        }]
                    })
                });

                alert("BaÅŸvuru gÃ¶nderildi.");
                location.reload();
            } catch (err) { alert("Hata: " + err.message); btn.disabled = false; btn.innerText = "Tekrar Dene"; }
        });
    </script>
</body>
</html>
